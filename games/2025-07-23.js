const stage=document.getElementById("game-of-the-day-stage");stage.innerHTML="";const canvas=document.createElement("canvas");canvas.width=720;canvas.height=480;stage.appendChild(canvas);const ctx=canvas.getContext("2d");let keys={};window.addEventListener("keydown",e=>keys[e.key.toLowerCase()]=true);window.addEventListener("keyup",e=>keys[e.key.toLowerCase()]=false);const tileSize=40;const worldCols=18;const worldRows=12;const worldWidth=worldCols*tileSize;const worldHeight=worldRows*tileSize;class Sound{constructor(src,volume=0.15){this.audio=new Audio(src);this.audio.volume=volume;this.audio.preload="auto"}play(){this.audio.currentTime=0;this.audio.play()}}const sounds={correct:new Sound("https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg",0.4),wrong:new Sound("https://actions.google.com/sounds/v1/cartoon/boing.ogg",0.35),background:new Sound("https://actions.google.com/sounds/v1/ambiences/forest_day.ogg",0.1)};sounds.background.audio.loop=true;sounds.background.play();class Explorer{constructor(){this.x=360;this.y=240;this.w=32;this.h=32;this.speed=3;this.color="#4bc8c8";this.name="Zee";this.collectCount=0;this.pulse=0;this.pulseDir=1}draw(){this.pulse+=0.06*this.pulseDir;if(this.pulse>0.3||this.pulse<0){this.pulseDir*=-1}ctx.save();ctx.translate(this.x+this.w/2,this.y+this.h/2);ctx.scale(1+this.pulse,1+this.pulse);ctx.translate(-(this.x+this.w/2),-(this.y+this.h/2));let grad=ctx.createRadialGradient(this.x+this.w/2,this.y+this.h/2,6,this.x+this.w/2,this.y+this.h/2,16);grad.addColorStop(0,"#69f9f9");grad.addColorStop(1,this.color);ctx.fillStyle=grad;ctx.beginPath();ctx.ellipse(this.x+this.w/2,this.y+this.h/2,this.w/2,this.h/2,0,0,Math.PI*2);ctx.fill();ctx.fillStyle="#065";ctx.beginPath();ctx.arc(this.x+this.w*0.7,this.y+this.h/3,6,0,Math.PI*2);ctx.fill();ctx.fillStyle="#e2d996";ctx.beginPath();ctx.arc(this.x+this.w/2,this.y+this.h*0.7,10,0,Math.PI);ctx.fill();ctx.strokeStyle="#0a504f";ctx.lineWidth=2;ctx.beginPath();ctx.moveTo(this.x+this.w*0.3,this.y+this.h*0.85);ctx.lineTo(this.x+this.w*0.7,this.y+this.h*0.85);ctx.stroke();ctx.restore()}move(){if(keys["arrowup"]||keys["w"]){this.y-=this.speed;if(this.y<0)this.y=0}if(keys["arrowdown"]||keys["s"]){this.y+=this.speed;if(this.y+this.h>worldHeight)this.y=worldHeight-this.h}if(keys["arrowleft"]||keys["a"]){this.x-=this.speed;if(this.x<0)this.x=0}if(keys["arrowright"]||keys["d"]){this.x+=this.speed;if(this.x+this.w>worldWidth)this.x=worldWidth-this.w}}}class FriendlyFrog{constructor(x,y){this.x=x;this.y=y;this.w=32;this.h=32;this.color="#50b778";this.question="";this.answer=0;this.asked=false;this.feelingHappy=false;this.happyTimer=0;this.blinkTimer=0}draw(){ctx.save();ctx.translate(this.x+this.w/2,this.y+this.h/2);let scale=1+0.02*Math.sin(Date.now()/150);ctx.scale(scale,scale);ctx.translate(-(this.x+this.w/2),-(this.y+this.h/2));let bodyGrad=ctx.createRadialGradient(this.x+this.w/2,this.y+this.h/2,this.w/4,this.x+this.w/2,this.y+this.h/2,this.w/2);bodyGrad.addColorStop(0,this.color);bodyGrad.addColorStop(1,"#0c461c");ctx.fillStyle=bodyGrad;ctx.beginPath();ctx.ellipse(this.x+this.w/2,this.y+this.h/2,this.w/2,this.h/2,0,0,Math.PI*2);ctx.fill();ctx.fillStyle="#144";ctx.beginPath();ctx.arc(this.x+this.w*0.3,this.y+this.h/3,5,0,Math.PI*2);ctx.fill();ctx.fillStyle="#144";ctx.beginPath();ctx.arc(this.x+this.w*0.7,this.y+this.h/3,5,0,Math.PI*2);ctx.fill();this.blinkTimer++;let eyeHeight=this.blinkTimer%120<10?1+7*Math.abs(Math.sin(this.blinkTimer/5)):10;ctx.fillStyle="#bde9c6";ctx.beginPath();ctx.ellipse(this.x+this.w/2,this.y+this.h*0.7,10,eyeHeight,0,0,Math.PI);ctx.fill();ctx.strokeStyle="#0b3b0f";ctx.lineWidth=2;ctx.beginPath();ctx.moveTo(this.x+this.w*0.25,this.y+this.h*0.85);ctx.lineTo(this.x+this.w*0.75,this.y+this.h*0.85);ctx.stroke();if(this.feelingHappy){let starAlpha=(Math.sin(Date.now()/200)+1)/2*0.8+0.2;ctx.fillStyle=`rgba(255,255,0,${starAlpha})`;ctx.font="bold 18px Comic Sans MS";ctx.fillText("⭐",this.x+this.w/2-8,this.y-8)}ctx.restore()}askQuestion(){if(this.asked)return;let a=Math.floor(Math.random()*10)+1;let b=Math.floor(Math.random()*10)+1;this.answer=a+b;this.question=`What is ${a} + ${b}?`;this.asked=true}happyTick(){if(this.happyTimer>0){this.happyTimer--;if(this.happyTimer===0)this.feelingHappy=false}}}const frogPositions=[{x:100,y:100},{x:560,y:80},{x:300,y:360},{x:620,y:420},{x:80,y:400}];const frogs=frogPositions.map(p=>new FriendlyFrog(p.x,p.y));const explorer=new Explorer();let currentFrog=null;let gameState="exploring";let inputAnswer="";function distance(ax,ay,bx,by){return Math.sqrt((ax-bx)**2+(ay-by)**2)}function drawBackground(){let grd=ctx.createLinearGradient(0,0,0,worldHeight);grd.addColorStop(0,"#a1d6ff");grd.addColorStop(1,"#448aff");ctx.fillStyle=grd;ctx.fillRect(0,0,worldWidth,worldHeight);for(let r=0;r<worldRows;r++){for(let c=0;c<worldCols;c++){ctx.strokeStyle="rgba(255,255,255,0.15)";ctx.lineWidth=0.8;ctx.beginPath();ctx.moveTo(c*tileSize,r*tileSize);ctx.lineTo(c*tileSize+tileSize,r*tileSize+tileSize);ctx.stroke();ctx.beginPath();ctx.moveTo(c*tileSize+tileSize,r*tileSize);ctx.lineTo(c*tileSize,r*tileSize+tileSize);ctx.stroke()}}}function drawTrees(){for(let i=0;i<15;i++){let tx=(i*50+30* Math.sin(Date.now()/3000+i))*0.9%worldWidth;let ty=((i*80+60)*0.7)%worldHeight;let sway=4*Math.sin(Date.now()/700+i);ctx.fillStyle="#186730";ctx.beginPath();ctx.moveTo(tx+5+sway,ty+25);ctx.lineTo(tx+20+sway,ty-8);ctx.lineTo(tx+35+sway,ty+25);ctx.closePath();let leafGrad=ctx.createRadialGradient(tx+20+sway,ty+5,10,tx+20+sway,ty+20,30);leafGrad.addColorStop(0,"#44af44");leafGrad.addColorStop(1,"#154a10");ctx.fillStyle=leafGrad;ctx.fill();ctx.fillStyle="#734b28";ctx.fillRect(tx+17+Math.sin(Date.now()/500+i)*2,ty+25,6,22)}}function drawHUD(){ctx.fillStyle="#edf3f4cc";ctx.shadowColor="black";ctx.shadowBlur=4;ctx.font="bold 22px Comic Sans MS";ctx.fillText(`Answers: ${explorer.collectCount} / ${frogs.length}`,16,34);ctx.shadowBlur=0}function gameLoop(){ctx.clearRect(0,0,worldWidth,worldHeight);drawBackground();drawTrees();explorer.move();explorer.draw();frogs.forEach(f=>{f.draw();f.happyTick()});drawHUD();if(gameState==="exploring"){for(let f of frogs){if(!f.asked&&distance(explorer.x+explorer.w/2,explorer.y+explorer.h/2,f.x+f.w/2,f.y+f.h/2)<55){currentFrog=f;gameState="asking";f.askQuestion();inputAnswer="";break}}}else if(gameState==="asking"){ctx.fillStyle="rgba(230,230,230,0.92)";ctx.shadowColor="rgba(0,0,0,0.15)";ctx.shadowBlur=12;ctx.fillRect(100,180,520,120);ctx.shadowBlur=0;ctx.strokeStyle="#17692c";ctx.lineWidth=3;ctx.strokeRect(100,180,520,120);ctx.fillStyle="#145a32";ctx.font="26px Comic Sans MS";ctx.fillText(currentFrog.question,130,230);ctx.font="20px Comic Sans MS";ctx.fillText("Type your answer & press Enter:",130,270);ctx.fillStyle="#0b703d";ctx.shadowColor="rgba(0,0,0,0.2)";ctx.shadowBlur=3;ctx.fillRect(400,250,120,44);ctx.shadowBlur=0;ctx.fillStyle="#d2ffe1";ctx.font="34px Comic Sans MS";ctx.fillText(inputAnswer,415,282);if(inputAnswer.length>0){let w=ctx.measureText(inputAnswer).width;ctx.fillText("_",415+w+8,282)}}requestAnimationFrame(gameLoop)}window.addEventListener("keydown",e=>{if(gameState==="asking"){if(e.key==="Enter"){if(inputAnswer.length>0){let num=Number(inputAnswer);if(num===currentFrog.answer){sounds.correct.play();currentFrog.feelingHappy=true;currentFrog.happyTimer=60*2;explorer.collectCount++;currentFrog=null;gameState="exploring"}else{sounds.wrong.play();}inputAnswer=""}}else if(e.key==="Backspace"){inputAnswer=inputAnswer.slice(0,-1)}else if(e.key>="0"&&e.key<="9"&&inputAnswer.length<3){inputAnswer+=e.key}}});gameLoop();