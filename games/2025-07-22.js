const stage=document.getElementById("game-of-the-day-stage");stage.innerHTML="";const canvas=document.createElement("canvas");canvas.width=720;canvas.height=480;stage.appendChild(canvas);const ctx=canvas.getContext("2d");const sounds={correct:new Audio("https://freesound.org/data/previews/109/109662_945474-lq.mp3"),incorrect:new Audio("https://freesound.org/data/previews/331/331912_3248244-lq.mp3")};let gameState={player:{x:360,y:400,w:40,h:40,color:"#ff6f61"},explorerName:"Zippy the Zog",score:0,questions:[],currentQ:null,answered:false,timer:0,items:[],bgColor:"#1a2935",isPlaying:true,starfield:[]};class FloatingCreature{constructor(x,y,color,pattern){this.x=x;this.y=y;this.color=color;this.pattern=pattern;this.size=30;this.wobble=0;}draw(){ctx.save();ctx.translate(this.x,this.y);ctx.rotate(Math.sin(this.wobble)*0.2);ctx.shadowColor=this.color;ctx.shadowBlur=12;ctx.fillStyle=this.color;ctx.beginPath();ctx.moveTo(0,-this.size/2);for(let i=0;i<5;i++){ctx.lineTo(this.size/2*Math.cos(i*2*Math.PI/5),this.size/2*Math.sin(i*2*Math.PI/5));ctx.lineTo(this.size/4*Math.cos((i+0.5)*2*Math.PI/5),this.size/4*Math.sin((i+0.5)*2*Math.PI/5));}ctx.fill();ctx.restore();this.wobble+=0.05;}update(){this.y+=Math.sin(this.wobble)*0.4+0.5;if(this.y>480)this.y=0;if(this.y<0)this.y=480;}}class FloatingLeaf{constructor(x,y,color){this.x=x;this.y=y;this.color=color;this.size=25;this.angle=0;this.speed=0.3+Math.random()*0.3;}draw(){ctx.save();ctx.translate(this.x,this.y);ctx.rotate(this.angle);ctx.fillStyle=this.color;ctx.shadowColor=this.color;ctx.shadowBlur=10;ctx.beginPath();ctx.moveTo(0,0);ctx.bezierCurveTo(15,-10,20,-30,0,-35);ctx.bezierCurveTo(-20,-30,-15,-10,0,0);ctx.fill();ctx.restore();}update(){this.y+=this.speed;this.angle+=0.02;this.x+=Math.sin(this.angle)*0.3;if(this.y>480)this.y=0;}}function randomInt(min,max){return Math.floor(Math.random()*(max-min+1))+min;}function generateQuestion(){let a=randomInt(1,10);let b=randomInt(1,10);return{a,b,answer:a+b,text:`${gameState.explorerName} found ${a} + ${b} glowing mushrooms! How many in total?`,userAnswer:null};}function spawnFloatingCreatures(){gameState.items=[];for(let i=0;i<5;i++){const c=new FloatingCreature(randomInt(20,700),randomInt(50,350),["#ffde59","#59ff8f","#598aff","#ffa459"][randomInt(0,3)]);gameState.items.push(c);}for(let i=0;i<6;i++){const leafColors=["#a7d129","#7fc241","#5d8a1f"]; const l=new FloatingLeaf(randomInt(20,700),randomInt(30,460),leafColors[randomInt(0,leafColors.length-1)]);gameState.items.push(l);}}function createStarfield(){gameState.starfield=[];for(let i=0;i<100;i++){gameState.starfield.push({x:Math.random()*720,y:Math.random()*480,radius:Math.random()*1.2+0.3,blinkPhase:Math.random()*2*Math.PI});}}function drawBackground(){ctx.fillStyle=gameState.bgColor;ctx.fillRect(0,0,720,480);for(let star of gameState.starfield){let opacity=(Math.sin(gameState.timer/30+star.blinkPhase)*0.5+0.5)*0.8+0.2;ctx.fillStyle=`rgba(255,255,255,${opacity.toFixed(2)})`;ctx.beginPath();ctx.shadowColor="white";ctx.shadowBlur=8;ctx.arc(star.x,star.y,star.radius,0,2*Math.PI);ctx.fill();ctx.shadowBlur=0;}ctx.fillStyle="rgba(26,41,53,0.35)";for(let i=0;i<720;i+=100){for(let j=0;j<480;j+=100){ctx.beginPath();ctx.ellipse(i+50,j+50,40,25,Math.sin((i+j+gameState.timer)/80)*0.2,0,2*Math.PI);ctx.fill();}}}function drawPlayer(){ctx.save();ctx.translate(gameState.player.x,gameState.player.y);ctx.shadowColor="#ff6f61";ctx.shadowBlur=10;ctx.fillStyle=gameState.player.color;ctx.beginPath();ctx.ellipse(0,0,22,32,0,0,2*Math.PI);ctx.fill();ctx.shadowBlur=0;ctx.fillStyle="#fff";ctx.beginPath();ctx.ellipse(-10,-7,7,10,0,0,2*Math.PI);ctx.ellipse(10,-7,7,10,0,0,2*Math.PI);ctx.fill();ctx.fillStyle="#000";ctx.beginPath();ctx.ellipse(-10,-7,3.5,6,0,0,2*Math.PI);ctx.ellipse(10,-7,3.5,6,0,0,2*Math.PI);ctx.fill();ctx.strokeStyle="#663300";ctx.lineWidth=4;ctx.beginPath();ctx.moveTo(-13,13);ctx.lineTo(13,13);ctx.stroke();ctx.restore();}function drawQuestion(){ctx.fillStyle="#faf3dd";ctx.font="bold 20px Comic Sans MS";ctx.textAlign="center";ctx.shadowColor="rgba(0,0,0,0.3)";ctx.shadowBlur=4;ctx.fillText(gameState.currentQ.text,360,60);ctx.shadowBlur=0;if(gameState.answered){ctx.fillStyle="#88c18d";ctx.font="bold 26px Comic Sans MS";ctx.fillText(`You answered: ${gameState.currentQ.userAnswer}`,360,440);}else{ctx.fillStyle="#a1c7ce";ctx.font="18px Comic Sans MS";ctx.fillText("Click the correct number below to help Zippy collect mushrooms!",360,440);}}function drawOptions(){const startX=120;const startY=320;const optionWidth=80;const optionHeight=60;ctx.textBaseline="middle";for(let i=0;i<7;i++){const val=gameState.currentQ.a+gameState.currentQ.b-3+i;if(val<0)continue;const rectX=startX+i*90;const rectY=startY;ctx.fillStyle="#faf3dd";ctx.shadowColor="rgba(0,0,0,0.25)";ctx.shadowBlur=6;ctx.strokeStyle="#b07aa1";ctx.lineWidth=3;ctx.beginPath();ctx.moveTo(rectX+15,rectY);ctx.lineTo(rectX+optionWidth-15,rectY);ctx.quadraticCurveTo(rectX+optionWidth,rectY,rectX+optionWidth,rectY+15);ctx.lineTo(rectX+optionWidth,rectY+optionHeight-15);ctx.quadraticCurveTo(rectX+optionWidth,rectY+optionHeight,rectX+optionWidth-15,rectY+optionHeight);ctx.lineTo(rectX+15,rectY+optionHeight);ctx.quadraticCurveTo(rectX,rectY+optionHeight,rectX,rectY+optionHeight-15);ctx.lineTo(rectX,rectY+15);ctx.quadraticCurveTo(rectX,rectY,rectX+15,rectY);ctx.closePath();ctx.fill();ctx.shadowBlur=0;ctx.stroke();ctx.fillStyle="#b07aa1";ctx.font="bold 34px Comic Sans MS";ctx.textAlign="center";ctx.fillText(val,rectX+optionWidth/2,rectY+optionHeight/2);}}function checkAnswer(x,y){const startX=120;const startY=320;const optionWidth=80;const optionHeight=60;if(y<startY||y>startY+optionHeight)return false;for(let i=0;i<7;i++){const rectX=startX+i*90;if(x>=rectX&&x<=rectX+optionWidth){const val=gameState.currentQ.a+gameState.currentQ.b-3+i;if(val<0)return false;gameState.currentQ.userAnswer=val;gameState.answered=true;if(val===gameState.currentQ.answer){gameState.score++;if(!sounds.correct.paused){sounds.correct.currentTime=0;}else{sounds.correct.play();}setTimeout(()=>{startNewQuestion();},1500);}else{if(!sounds.incorrect.paused){sounds.incorrect.currentTime=0;}else{sounds.incorrect.play();}}return true;}}return false;}function drawScore(){ctx.fillStyle="#faf3dd";ctx.font="bold 20px Comic Sans MS";ctx.textAlign="left";ctx.shadowColor="rgba(0,0,0,0.4)";ctx.shadowBlur=3;ctx.fillText(`Mushrooms Collected: ${gameState.score}`,14,34);ctx.shadowBlur=0;}function drawExplorersBadge(){ctx.save();ctx.shadowColor="rgba(0,0,0,0.3)";ctx.shadowBlur=6;ctx.fillStyle="#f7c59f";ctx.beginPath();ctx.ellipse(660,40,42,32,0,0,2*Math.PI);ctx.fill();ctx.fillStyle="#72564b";ctx.font="bold 15px Comic Sans MS";ctx.textAlign="center";ctx.fillText(gameState.explorerName,660,45);ctx.restore();}function startNewQuestion(){gameState.currentQ=generateQuestion();gameState.answered=false;spawnFloatingCreatures();}canvas.addEventListener("click",e=>{if(!gameState.isPlaying)return;const rect=canvas.getBoundingClientRect();const x=e.clientX-rect.left;const y=e.clientY-rect.top;if(gameState.answered)return;if(checkAnswer(x,y)){}else{} });createStarfield();startNewQuestion();function gameLoop(){ctx.clearRect(0,0,720,480);drawBackground();gameState.items.forEach(c=>{c.update();c.draw();});drawPlayer();drawQuestion();drawOptions();drawScore();drawExplorersBadge();gameState.timer++;requestAnimationFrame(gameLoop);}gameLoop();const bgMusic=new Audio("https://cdn.pixabay.com/download/audio/2022/03/20/audio_c2a0a87f66.mp3?filename=relax-guitar-1341.mp3");bgMusic.loop=true;bgMusic.volume=0.1;bgMusic.play().catch(()=>{});